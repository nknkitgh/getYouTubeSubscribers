function getYouTubeChannelInfo() {
  // スプレッドシートとシートの取得
  var sheet = SpreadsheetApp.openById('1x5pntmQB1cgonogxk-NTjC0mQDL0O_ezKD092RqlH_w').getActiveSheet();
  var data = sheet.getRange('A2:A' + sheet.getLastRow()).getValues();
  
  // YouTube Data APIのURL
  var apiKey = 'YOUR_API_KEY';
  var apiBaseUrl = 'https://www.googleapis.com/youtube/v3/';
  
  // 取得したデータを元に各チャンネルの情報を取得
  data.forEach(function(row, index) {
    var url = row[0];
    if (url) {
      var username = url.split('@')[1];
      
      // チャンネルIDの取得
      var searchUrl = apiBaseUrl + 'search?part=snippet&type=channel&q=' + username + '&key=' + apiKey;
      var response = UrlFetchApp.fetch(searchUrl);
      var searchResults = JSON.parse(response.getContentText());
      
      if (searchResults.items && searchResults.items.length > 0) {
        var channel = searchResults.items[0];
        var channelId = channel.id.channelId;
        
        // チャンネル情報の取得
        var channelUrl = apiBaseUrl + 'channels?part=snippet,statistics&id=' + channelId + '&key=' + apiKey;
        var channelResponse = UrlFetchApp.fetch(channelUrl);
        var channelInfo = JSON.parse(channelResponse.getContentText());
        
        if (channelInfo.items && channelInfo.items.length > 0) {
          var channelDetails = channelInfo.items[0];
          var snippet = channelDetails.snippet;
          var statistics = channelDetails.statistics;
          
          // スプレッドシートにデータを書き込み
          sheet.getRange(index + 2, 2).setValue(snippet.title); // チャンネル名
          sheet.getRange(index + 2, 3).setValue(snippet.thumbnails.default.url); // チャンネルアイコン
          sheet.getRange(index + 2, 4).setValue(snippet.description); // 概要
          sheet.getRange(index + 2, 5).setValue(statistics.subscriberCount); // チャンネル登録数
          sheet.getRange(index + 2, 6).setValue(statistics.videoCount); // 動画本数
        }
      }
    }
  });
}
